= GMCP mapper (`aard_GMCP_mapper.xml` and `aardmapper.lua`) =

A dynamically updated mapper that enables rapid navigation by storing room information in a SQLite database.


<wiki:toc max_depth="2" />

== What does it look like? ==
Probably something like this

http://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/gmcpmapper.png

== Are there any configuration options? ==
Oh, yeah. Tons of them! See that little box in the top left corner of the mapper that looks like `[*]`? Click on that to bring up a display configuration menu. (Click on the `[x]` to close it again.)

In this menu, all of the items are clickable. If the item is a color, then a color picker dialog will come up. If the item is a number, then a number input dialog will come up. And so on.

http://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/gmcpmapperconfig.png

== Are there any special commands for using the mapper? ==
Many! To see the entire list, type
{{{
mapper help
}}}
and you'll see:
{{{
[MUSHclient mapper, version 2.5]
AUTOMATIC MAPPER ... Originally by Nick Gammon
** This plugin is a significantly improved GMCP version of the original ATCP mapper by Nick Gammon.
** Some GMCP specific code added by Lasher.
** A few major new features contributed by Spartacus.
** Many bugs squashed and improvements made by Fiendish.

The window can be dragged to a new location by dragging the room name.
Your current room is always in the center with a bolder border.
LH-click on a room to speed-walk to it. RH-click on a room for options.

LH-click on the "*" button on the upper-left corner for configuration settings.
(click again on the [x] to close configuration)

===== ACTIONS ===================>

mapper backup                  --> Create new archived backup of your map
                                 > database in a db_backups directory,
                                 > preserving a few prior backups
mapper backups <off/on>        --> Turn off or on automatic database backups
                                 > The default setting is on
mapper backups [un]compressed  --> Turn off or on database backup compression
                                 > The default setting is uncompressed (off)
mapper help                    --> This help
                                 > (or click the "?" button on the top right)
mapper zoom out                --> Zoom out
mapper zoom in                 --> Zoom in
mapper hide                    --> Hide map
mapper show                    --> Show map
mapper addnote                 --> Add a new note to the current room
mapper purgezone <area>        --> Remove an area from the map database

===== CUSTOM EXIT ACTIONS =======>

mapper cexits                  --> List known custom exits
mapper cexits <here/area>      --> List known custom exits only in this or
                                 > another area
mapper cexit <command>         --> Follow and link a custom exit
                                 > (ex: 'mapper cexit ride bucket')
                                 > To insert a pause during execution
                                 > of the cexit, use wait(<seconds>) as one
                                 > or more of the cexit moves
                                 > To stack commands use ;; as separator
                                 > to get around the line break parser
                                 > (ex: 'mapper cexit open south;;south')
mapper delete cexits           --> Remove the custom exits from this room
mapper purge cexits            --> Remove all custom exits
mapper cexit_wait <seconds>    --> Wait the given number of seconds instead of
                                 > the standard 2 when constructing the next
                                 > cexit (between 2 and 30)

===== PORTAL ACTIONS ============>

mapper portals                 --> List known hand-held portals
                                 > Recall-flagged portals (below) show in red
mapper portal <command>        --> Link a hand-held portal alias to the
                                 > current location as a custom exit 
                                 > (ex: 'mapper portal recall' at recall)
                                 > To stack commands use ;; as separator
                                 > to get around the line break parser
                                 > (ex: 'mapper portal hold amulet;;enter')
mapper portalrecall <index>    --> Flag/unflag a portal as using the recall or
                                 > home features, to avoid using it in 
                                 > identified norecall rooms
mapper portallevel <ind> <lvl> --> Change the level lock on a stored portal
                                 > Find the indices with 'mapper portals'
                                 > Do not manually account for tiers
mapper delete portal <command> --> Remove the specified hand-held portal alias
mapper delete portal #<index>  --> Remove a hand-held portal by its index
                                 > Find the indices with 'mapper portals'
mapper purge portals           --> Remove all hand-held portal aliases

===== FINDING THINGS ============>

mapper quicklist [on/off]      --> ON will cause search results to display much
                                 > faster, but the results will not be sorted
                                 > by distance (default is off)
mapper notes                   --> Show nearby rooms that you marked with notes
mapper area <text>             --> Full-text search limited to the current zone
mapper find <text>             --> Full-text search the whole database
mapper list <text>             --> Find rooms without the known-path limits
                                 > of "area" and "find"
mapper shops                   --> Show all shops/banks
mapper shops <here/area>       --> Ditto
mapper train                   --> Show all trainers
mapper train <here/area>       --> Ditto
mapper quest                   --> Show all quest-givers
mapper quest <here/area>       --> Ditto
mapper where <room id>         --> Show directions to a room number

mapper next                    --> Visit the next room in the most recent
                                 > list of results.

===== EXPLORING =================>

mapper thisroom                --> Show details about the current room
mapper areas                   --> Show a list of all mapped areas
mapper areas <name>            --> Show a list of mapped areas partially
                                 > matching <name>
mapper unmapped                --> List unmapped exit counts for know areas
mapper unmapped <here/area>    --> List unmapped exits in this or another area

===== MOVING ====================>

mapper goto <room id>          --> Walk to a room by its room number
mapper resume                  --> Initiate a new run to the previous target
}}}

== Where am I on the mapper? ==
Your current position is the room box in the middle with the bold outline in the color specified as "Our room" in the configuration menu.

== Can I right click anywhere? ==
You can right click on any of the rooms currently being displayed. This will bring up a small menu of room-related options.

http://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/gmcpmapperright.png

== How do I get details about a room? ==
If you hover your mouse over any room, you will see a bubble pop up with information about that room.

http://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/gmcpmapperbubble.png

Or if you're in the room you can use the command

{{{
mapper thisroom
}}}

and you'll see something like this

http://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/thisroom.png

== When I go out on the continents the mapper looks different. What is this? ==

Are you confused about this?

https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/bigmapcompare.png

Original versions of the package did not yet include the ability to show what is called the 'bigmap'. If you need access to the old gmcp map tiles on the continents (to add notes or change exits by mouse) you can toggle the bigmap view either by typing:
{{{
bigmap off
}}}
and
{{{
bigmap on
}}}
or through the right-click menu options

https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/hide_bigmap_menu.png

https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/show_bigmap_menu.png

For more information on this see the page for [Bigmap the merged Bigmap plugin].

== Can I block dangerous routes? ==

You can achieve this by assigning level locks to dangerous exits. To assign a level lock to an exit, right click on the "from" room (all exits are defined as being _from_ one room _to_ another) and choose *Change Exit Level Lock*.


https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/gmcpmapperexitlockmenu.png

Then select the exit from that room to which you want to add a level lock, and click OK.

https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/gmcpmapperexitlockdialog.png

Then choose your level to lock under. Keep in mind that these locks automatically take tiers into account. So a lock of level 50 will be open to a Tier 1 at level 40 and a Tier 5+ at level 1. The example below uses 300, which will always be locked for any level of any tier.

https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/gmcpmapperexitlocklevel.png

If you click OK, the chosen exit from the chosen room will be assigned the chosen lock level. 

Locked exits display in the mapper in red instead of white.

https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/gmcpmapperexitlockmarking.png

== Configuring the norecall/noportal assistance ==

Understanding what this does:
Sometimes the shortest path from where you are to where you want to go starts with entering a portal, but you happen to be in a noportal room so that just won't work. Likewise, maybe the shortest path starts with a 'home' or 'recall' command, but you happen to be in a norecall room. When configured correctly the mapper can find the nearest walkable room that allows you to escape the prison and, if necessary, bounce through a portal to get to recall or bounce through recall to get to a portal destination.

  * *portalrecall* - Tells the mapper that a particular 'mapper portals' entry  won't work in a norecall room because it uses the home or recall commands.
  * *bouncerecall* - Bounce through this 'portalrecall' flagged mapper-portal in the scenario where the shortest path wants to enter a portal but you are in a noportal room.
  * *bounceportal* - Bounce through this non-recall mapper-portal in the scenario where the shortest path wants to recall or home but you are in a norecall room.

The steps for using the portalrecall, bouncerecall, and bounceportal commands may not be immediately obvious to everyone. Follow this example for configuring the mapper to robustly handle finding paths from noportal and norecall rooms.

  # Type 'mapper portals' to show the list of your current portals and find index numbers<BR><BR>https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/mapperportalsexample.png
  # Type something like 'mapper portalrecall 2' to mark a particular portal as using the home or recall game commands<BR><BR>https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/mapperportalrecallflag.png<BR><BR>recallportals will show up in red when viewing the 'mapper portals' list and the mapper will know not to use them from norecall rooms but that they are safe for noportal rooms<BR><BR>https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/mapperportalsrecallexample.png
  # Type something like 'mapper bounceportal 1' to mark a particular non-recall/home mapper-portal as being the command you always want to bounce through when the mapper wants to recall or home while you are in a norecall room. This interface may change in the future.<BR><BR>https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/mapperbounceportal.png<BR><BR>
  # Type something like 'mapper bouncerecall 2' to mark a particular recall-flagged mapper-portal as being the command you always want to bounce through when the mapper wants to use a handheld portal while you are in a noportal room.<BR><BR>https://aardwolfclientpackage.googlecode.com/svn/trunk/wiki_images/mapperbouncerecall.png<BR><BR>Note: You will not be allowed to set an index as the bouncerecall command if it is not already flagged 'portalrecall' like above. This interface may change in the future.
